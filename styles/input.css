@tailwind base;
@tailwind components;
@tailwind utilities;

/* === CUSTOM BASE STYLES === */
@layer base {
  /* Improve Thai text justification for prose content. */
  .prose {
    text-align: justify;
    hyphens: auto;
    overflow-wrap: break-word;
  }

  body {
    font-family: "Sarabun", sans-serif;
    word-break: thai;
    background-color: white;
    color: #111827;
    animation: fade-in 0.5s ease-in-out;
  }

  .font-kanit {
    font-family: "Kanit", sans-serif;
    word-break: thai;
    text-justify: inter-word;
  }

  html {
    overflow-y: scroll;
    scroll-behavior: smooth;
    scroll-padding-top: 5rem;
    scrollbar-width: thin;
    scrollbar-color: #cbd5e1 #f1f5f9;
  }

  body.dark {
    background-color: #020617;
    color: #f3f4f6;
    /* Custom dark mode background with subtle pattern */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4' viewBox='0 0 4 4'%3E%3Cpath fill='%231e293b' fill-opacity='0.4' d='M1 3h1v1H1V3zm2-2h1v1H3V1z'%3E%3C/path%3E%3C/svg%3E");
    animation: move-bg 10s linear infinite;
  }

  .dark html {
    scrollbar-color: #4a5568 #1a202c;
  }

  /* === UNIFIED SCROLLBAR STYLES === */
  ::-webkit-scrollbar {
    width: 12px;
    height: 12px;
  }

  ::-webkit-scrollbar-track {
    background: #f8fafc;
  }

  .dark ::-webkit-scrollbar-track {
    background: #0f172a;
  }

  ::-webkit-scrollbar-thumb {
    background-color: #cbd5e1;
    border-radius: 20px;
    border: 3px solid #f8fafc;
  }

  .dark ::-webkit-scrollbar-thumb {
    background-color: #475569;
    border: 3px solid #0f172a;
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: #94a3b8;
  }

  .dark ::-webkit-scrollbar-thumb:hover {
    background-color: #334155;
  }
  
  /* Autofill Styles */
  input:-webkit-autofill,
  input:-webkit-autofill:hover,
  input:-webkit-autofill:focus,
  input:-webkit-autofill:active {
    -webkit-box-shadow: 0 0 0px 1000px #ffffff inset !important;
    -webkit-transition: background-color 600000s 0s, color 600000s 0s;
    transition: background-color 600000s 0s, color 600000s 0s;
    -webkit-text-fill-color: #000000 !important;
  }

  .dark input:-webkit-autofill,
  .dark input:-webkit-autofill:hover,
  .dark input:-webkit-autofill:focus,
  .dark input:-webkit-autofill:active {
    -webkit-box-shadow: 0 0 0px 1000px #020617 inset !important;
    -webkit-text-fill-color: #f3f4f6 !important;
    -webkit-transition: background-color 600000s 0s, color 600000s 0s;
    transition: background-color 600000s 0s, color 600000s 0s;
  }
}

/* === CUSTOM COMPONENTS === */
@layer components {
  .container {
    width: 100%;
  }
  @media (min-width: 640px) { .container { max-width: 640px; } }
  @media (min-width: 768px) { .container { max-width: 768px; } }
  @media (min-width: 1024px) { .container { max-width: 1024px; } }
  @media (min-width: 1280px) { .container { max-width: 1280px; } }
  @media (min-width: 1536px) { .container { max-width: 1536px; } }

  .dark .stats-card {
    background-color: rgba(31, 41, 55, 0.5);
    border-color: #374151;
  }

  .quiz-card .flex-shrink-0,
  .section-icon-container,
  .quiz-menu-item .h-8,
  .custom-quiz-item .flex-shrink-0,
  #profile-avatar-display,
  .stat-quiz-card .flex-shrink-0 {
    overflow: hidden;
  }

  /* Merged from styles/quiz.css */
  #question, .option-btn, #feedback, #review-container {
    word-break: keep-all;
    overflow-wrap: break-word;
    line-height: 1.75;
  }

  .question-card, .prose {
    word-break: keep-all;
    overflow-wrap: break-word;
    line-height: 1.75;
  }

  .question-card h2, .question-card .font-semibold {
    text-align: left;
  }

  #question img, #preview-container img, #review-container img {
    display: block;
    max-width: 100% !important;
    width: auto !important;
    height: auto !important;
    margin-left: auto;
    margin-right: auto;
    margin-top: 0.75rem;
    margin-bottom: 0.75rem;
    border-radius: 0.5rem;
  }
  
  .correct {
    background-color: #22c55e !important;
    color: white !important;
    border-color: #16a34a !important;
  }

  .feedback-content {
    max-height: 200px;
    overflow-y: auto;
  }

  .custom-scrollbar-menu,
  .feedback-content {
    scrollbar-width: thin;
    scrollbar-color: #a0aec0 #e2e8f0;
  }

  .dark .custom-scrollbar-menu,
  .dark .feedback-content {
    scrollbar-color: #718096 #2d3748;
  }

  .custom-scrollbar-menu::-webkit-scrollbar,
  .feedback-content::-webkit-scrollbar {
    width: 8px;
  }

  .custom-scrollbar-menu::-webkit-scrollbar-track,
  .feedback-content::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar-menu::-webkit-scrollbar-thumb,
  .feedback-content::-webkit-scrollbar-thumb {
    background-color: #a0aec0;
    border-radius: 20px;
    border: 2px solid #ffffff;
  }

  .dark .custom-scrollbar-menu::-webkit-scrollbar-thumb,
  .dark .feedback-content::-webkit-scrollbar-thumb {
    background-color: #718096;
    border: 2px solid #1f2937;
  }

  #custom-quiz-modal > div {
    display: flex;
    flex-direction: column;
    max-height: 90vh;
    overflow: hidden;
  }

  #custom-quiz-category-selection {
    flex-grow: 1;
    overflow-y: auto;
    padding-bottom: 1rem;
  }

  .modal {
    transition: opacity 0.3s ease-in-out;
  }

  .modal:not(.is-open) {
    opacity: 0;
    pointer-events: none;
  }

  .modal.is-open {
    opacity: 1;
  }

  .modal .modal-container {
    opacity: 0;
    transform: scale(0.95) translateY(1rem);
    transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
  }

  .modal.is-open .modal-container {
    opacity: 1;
    transform: scale(1) translateY(0);
  }

  .modern-scrollbar::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .modern-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .modern-scrollbar::-webkit-scrollbar-thumb {
    background-color: #d1d5db;
    border-radius: 20px;
    border: 2px solid transparent;
    background-clip: content-box;
  }

  .modern-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: #9ca3af;
  }

  .dark .modern-scrollbar::-webkit-scrollbar-thumb {
    background-color: #4b5563;
  }

  .dark .modern-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: #374151;
  }

  .modern-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: #d1d5db transparent;
  }

  .dark .modern-scrollbar {
    scrollbar-color: #4b5563 transparent;
  }
  
  .bg-grid-slate-100 {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='rgb(226 232 240 / 1)'%3e%3cpath d='M0 .5H31.5V32'/%3e%3c/svg%3e");
  }

  .dark .dark\:bg-grid-slate-700\/25 {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='rgb(51 65 85 / 0.25)'%3e%3cpath d='M0 .5H31.5V32'/%3e%3c/svg%3e");
  }
  
  .dark .shimmer-effect::after {
    background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0) 100%);
  }
}

/* === UTILITIES & ANIMATIONS === */
@layer utilities {
  .fade-in-up {
    animation: fadeIn 0.6s ease-out forwards;
  }
  
  .anim-backdrop-fade-in {
    animation: backdrop-fade-in 0.3s ease-out forwards;
  }
  
  .anim-modal-pop-in {
    animation: modal-pop-in 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
  }
  
  .anim-shake {
    animation: shake-horizontal 0.5s cubic-bezier(.36,.07,.19,.97) both;
  }

  /* New Bonus Animation */
  .anim-bonus-pop {
    animation: bonus-pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
  }
}

/* === KEYFRAMES === */
@keyframes pulse-glow-indigo {
  0%, 100% { box-shadow: 0 0 12px rgba(99, 102, 241, 0.3); }
  50% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.6); }
}
@keyframes pulse-glow-blue {
  0%, 100% { box-shadow: 0 0 12px rgba(37, 99, 235, 0.4); }
  50% { box-shadow: 0 0 20px rgba(37, 99, 235, 0.7); }
}
@keyframes pulse-glow-teal {
  0%, 100% { box-shadow: 0 0 12px rgba(20, 184, 166, 0.3); }
  50% { box-shadow: 0 0 20px rgba(20, 184, 166, 0.6); }
}
@keyframes pulse-glow-red {
  0%, 100% { box-shadow: 0 0 12px rgba(239, 68, 68, 0.3); }
  50% { box-shadow: 0 0 20px rgba(239, 68, 68, 0.6); }
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes card-pop-in {
  from { opacity: 0; transform: translateY(15px) scale(0.95); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}
@keyframes move-bg {
  from { background-position: 0 0; }
  to { background-position: 80px 80px; }
}
@keyframes progress-bar-stripes {
  from { background-position: 2rem 0; }
  to { background-position: 0 0; }
}
@keyframes shake-horizontal {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
  20%, 40%, 60%, 80% { transform: translateX(5px); }
}
@keyframes screenFadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes screenFadeOut {
  from { opacity: 1; transform: translateY(0); }
  to { opacity: 0; transform: translateY(-10px); }
}
@keyframes backdrop-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes backdrop-fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}
@keyframes modal-pop-in {
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1); }
}
@keyframes modal-pop-out {
  from { opacity: 1; transform: scale(1); }
  to { opacity: 0; transform: scale(0.95); }
}
@keyframes dropdown-in {
  from { opacity: 0; transform: scale(0.95) translateY(-10px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}
@keyframes dropdown-out {
  from { opacity: 1; transform: scale(1) translateY(0); }
  to { opacity: 0; transform: scale(0.95) translateY(-10px); }
}
@keyframes feedback-slide-in {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes pulse-warning {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}
@keyframes option-select-pop {
  0% { transform: scale(1); }
  50% { transform: scale(1.03); }
  100% { transform: scale(1); }
}
@keyframes card-appear {
  from { opacity: 0; transform: translateY(20px) scale(0.98); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}
@keyframes shake {
  10%, 90% { transform: translate3d(-1px, 0, 0); }
  20%, 80% { transform: translate3d(2px, 0, 0); }
  30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
  40%, 60% { transform: translate3d(4px, 0, 0); }
}
@keyframes correct-pulse {
  0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(22, 163, 74, 0.7); }
  70% { transform: scale(1.02); box-shadow: 0 0 0 12px rgba(22, 163, 74, 0); }
  100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(22, 163, 74, 0); }
}
@keyframes shimmer {
  0% { transform: translateX(-150%) skewX(-15deg); }
  40%, 100% { transform: translateX(150%) skewX(-15deg); }
}
@keyframes correct-pop {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}
@keyframes bonus-pop {
  0% { transform: scale(0.5); opacity: 0; }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); opacity: 1; }
}
